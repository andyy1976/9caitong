define("new/js/page/getpassword",["new/css/layer.css","$","layer","new/js/mod/util/minLength","new/js/mod/util/verify","new/js/mod/util/lang"],function(e){function n(){clearTimeout(l),a>0?(l=setTimeout(n,1e3),t("#get_regsms_code").val(a+"秒后重新获取"),t("#get_regsms_code").addClass("btn_disable"),a--):(c=!1,t("#get_regsms_code").removeClass("btn_disable"),t("#get_regsms_code").val("重新获取验证码"),a=0)}e("new/css/layer.css");var t=e("$"),o=e("layer"),s=e("new/js/mod/util/minLength").minLength,r=e("new/js/mod/util/verify").verify_phone,i=(e("new/js/mod/util/verify").verify_IDcard,e("new/js/mod/util/lang").lang),l=null,c=!1,a=0;t("#get_regsms_code").click(function(){if(c||t(this).hasClass(".btn_disable"))return!1;var e=t.trim(t("#bound_phone").val());if(!e)return o.tips(i.EMPTY_PHONE,"#bound_phone"),t("#bound_phone").focus(),!1;if(!r(e))return o.tips(i.ERROR_PHONE,"#bound_phone"),t("#bound_phone").focus(),!1;var l=t.trim(t("#Verifycode").val());if(0==l.length)return o.tips(i.EMPTY_PIC_CODE,"#Verifycode",{tips:1}),t("#Verifycode").focus(),!1;if(!s(l,4,!1))return o.tips(i.ERROR_PIC_CODE,"#Verifycode",{tips:1}),t("#Verifycode").focus(),!1;o.load(1);var _=new Object,d="/index.php?ctl=ajax&act=send_phone_verifycode_five";_.user_mobile=e,_.Verifycode=l,t.ajax({type:"post",url:d,dataType:"json",data:_,async:!0,success:function(e){return o.closeAll("loading"),e.status?(a=60,n(),c=!0,o.alert(e.info,{icon:6,title:"成功",closeBtn:0},function(){o.closeAll(),t("#sms_code").focus()}),void 0):(t("#Jverify_img").attr("src","/verify.php?w=89&h=44&rand="+Math.random()),o.alert(e.info,{icon:5,title:"提示",closeBtn:0}),t("#bound_phone").focus(),!1)},error:function(){return o.closeAll("loading"),o.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})}),t("#get_pwd_submit").click(function(){var e=t.trim(t("#bound_phone").val());if(!e)return o.tips(i.EMPTY_PHONE,"#bound_phone"),t("#bound_phone").focus(),!1;if(!r(e))return o.tips(i.ERROR_PHONE,"#bound_phone"),t("#bound_phone").focus(),!1;var n=t.trim(t("#sms_code").val());if(0==n.length)return o.tips(i.EMPTY_PHONE_CODE,"#sms_code"),t("#sms_code").focus(),!1;if(n.length<6)return o.tips(i.ERROR_PHONE_CODE,"#sms_code"),t("#sms_code").focus(),!1;var s=t.trim(t("#new_pwd").val()),l=/^[a-zA-z0-9]{6,}$/,c=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/;if(0==s.length)return o.tips(i.EMPTY_NEW_PWD,"#new_pwd"),t("#new_pwd").focus(),!1;if(!l.test(s))return o.tips(i.ERROR_PWD,"#new_pwd"),t("#new_pwd").focus(),!1;if(!c.test(s))return o.tips(i.ERROR_PWD,"#new_pwd"),t("#new_pwd").focus(),!1;var a=t.trim(t("#confirm_new_pwd").val());if(s!=a)return o.tips(i.NOTSAME_PWD,"#confirm_new_pwd"),!1;o.load(1);var _=new Object;_.phone=e,_.pwd=s,_.sms_code=n,t("#referer_num").val()&&(_.referer=t.trim(t("#referer_num").val()));var d=t("#get_pwd_form").attr("ajax_url");t.ajax({type:"post",url:d,dataType:"json",data:_,async:!0,success:function(e){return o.closeAll("loading"),e.status?void o.alert(e.info,{icon:6,title:"成功",closeBtn:0},function(){window.location.href=e.jump}):(o.alert(e.info,{icon:5,title:"提示",closeBtn:0}),!1)},error:function(){return o.closeAll("loading"),o.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})})});