define("new/js/page/page_reg",["new/css/layer.css","$","layer","new/js/mod/util/minLength","new/js/mod/util/verify","new/js/mod/util/FW_Password","new/js/mod/util/lang","new/js/mod/util/OnlyNum"],function(e){function t(){clearTimeout(c),l>0?(c=setTimeout(t,1e3),r("#get_regsms_code").val(l+"秒后重新获取"),r("#get_regsms_code").addClass("btn_disable"),l--):(_=!1,r("#get_regsms_code").removeClass("btn_disable"),r("#get_regsms_code").val("重新获取验证码"),l=0)}e("new/css/layer.css");var r=e("$"),n=e("layer"),a=e("new/js/mod/util/minLength").minLength,s=e("new/js/mod/util/verify").verify_phone,o=e("new/js/mod/util/verify").verify_IDcard,i=(e("new/js/mod/util/FW_Password").FW_Password,e("new/js/mod/util/lang").lang);e("new/js/mod/util/OnlyNum");var c=null,_=!1,l=0;r("#get_regsms_code").click(function(){if(_||r(this).hasClass(".btn_disable"))return!1;var e=r.trim(r("#user_reg_phone").val());if(!e)return n.tips(i.EMPTY_PHONE,"#user_reg_phone"),r("#user_reg_phone").focus(),!1;if(!s(e))return n.tips(i.ERROR_PHONE,"#user_reg_phone"),r("#user_reg_phone").focus(),!1;var o=r.trim(r("#Verifycode").val());if(0==o.length)return n.tips(i.EMPTY_PIC_CODE,"#Verifycode",{tips:1}),r("#Verifycode").focus(),!1;if(!a(o,4,!1))return n.tips(i.ERROR_PIC_CODE,"#Verifycode",{tips:1}),r("#Verifycode").focus(),!1;n.load(1);var c=new Object,u="/index.php?ctl=ajax&act=send_phone_verifycode_one";c.user_mobile=e,c.Verifycode=o,r.ajax({type:"post",url:u,dataType:"json",data:c,async:!0,success:function(e){return n.closeAll("loading"),e.status?(_=!0,l=60,t(),n.alert(e.info,{icon:6,title:"成功",closeBtn:0},function(){n.closeAll(),r("#sms_code").focus()}),void 0):(n.alert(e.info,{icon:5,title:"提示",closeBtn:0},function(){r("#Jverify_img").attr("src","/verify.php?w=89&h=44&rand="+Math.random()),n.closeAll()}),!1)},error:function(){return n.closeAll("loading"),n.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})}),r(".page_reg_submit").click(function(){var e=r.trim(r("#user_reg_phone").val());if(!e)return n.tips(i.EMPTY_PHONE,"#user_reg_phone"),r("#user_reg_phone").focus(),!1;if(!s(e))return n.tips(i.ERROR_PHONE,"#user_reg_phone"),r("#user_reg_phone").focus(),!1;var t=r.trim(r("#sms_code").val());if(!t)return n.tips(i.EMPTY_PHONE_CODE,"#sms_code"),r("#sms_code").focus(),!1;if(6!=t.length)return n.tips(i.ERROR_PHONE_CODE,"#sms_code"),r("#sms_code").focus(),!1;var a=r.trim(r("#user_reg_pwd").val()),o=/^[a-zA-z0-9]{6,}$/,c=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/;if(0==a.length)return n.tips(i.EMPTY_PWD,"#user_reg_pwd"),r("#user_reg_pwd").focus(),!1;if(!o.test(a))return n.tips(i.ERROR_PWD,"#user_reg_pwd"),r("#user_reg_pwd").focus(),!1;if(!c.test(a))return n.tips(i.ERROR_PWD,"#user_reg_pwd"),r("#user_reg_pwd").focus(),!1;var _=r.trim(r("#user_reg_verify_pwd").val());if(a!=_)return n.tips(i.NOTSAME_PWD,"#user_reg_verify_pwd"),r("#user_reg_verify_pwd").focus(),!1;if(r.trim(r("#referer_num").val()).length>0){var l=r.trim(r("#referer_num").val());if(!s(l))return n.tips(i.ERROR_INVITE_CODE,"#referer_num"),r("#referer_num").focus(),!1}if(!r("#agreement").attr("checked"))return n.tips("请同意注册协议","#agreement",{tips:1}),!1;n.load(1);var u=new Object;u.mobile=e,u.user_pwd=a,u.user_name="w"+e,u.sms_code=t,r("#referer_num").val()&&(u.referer=r.trim(r("#referer_num").val()));var p=r(this).attr("ajax_url");r.ajax({type:"post",url:p,dataType:"json",data:u,async:!0,success:function(e){if(n.closeAll("loading"),1==e.status)n.open({type:1,title:!1,closeBtn:1,shadeClose:!1,area:["652px"],move:!1,content:e.info});else{if(2!=e.status)return n.alert(e.info,{icon:5,title:"提示",closeBtn:0}),!1;window.location.href=e.jump}},error:function(){return n.closeAll("loading"),n.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})}),r("#page_reg_step2_submit").click(function(){var e=r.trim(r("#user_realname").val());if(!e)return n.tips(i.EMPTY_REALNAME,"#user_realname",{tips:1}),r("#user_realname").focus(),!1;var t=r.trim(r("#user_IDcard").val());if(!t)return n.tips(i.EMPTY_IDCARD,"#user_IDcard",{tips:1}),r("#user_IDcard").focus(),!1;if(!o(t))return n.tips(i.ERROR_IDCARD,"#user_IDcard",{tips:1}),r("#user_IDcard").focus(),!1;n.load(1);var a=new Object,s=r("#page_reg_steptwo").attr("ajax_url");a.real_name=e,a.IDcard=t,r.ajax({type:"post",url:s,dataType:"json",data:a,async:!0,success:function(e){return n.closeAll("loading"),e.status?void(window.location.href=e.jump):(n.alert(e.info,{icon:5,title:"提示",closeBtn:0}),!1)},error:function(){return n.closeAll("loading"),n.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})}),r("#P_account,#P_account_bank_num").OnlyNum(),r("#company_register .btn_tip").click(function(){var e=r(this).siblings(".hide");r(this).hasClass("nopic")?n.alert("请拨打银行热线或到营业厅进行咨询",{title:"提示",closeBtn:0}):n.open({type:1,title:!1,closeBtn:0,area:"726px",skin:"layui-layer-nobg",shadeClose:!0,content:e})}),r("#page_reg_step2_submit_company").click(function(){if(!r.trim(r("#company_name").val()))return n.tips("请输入企业名称","#company_name"),r("#company_name").focus(),!1;if(!r.trim(r("#corporate").val()))return n.tips("请输入法人","#corporate"),r("#corporate").focus(),!1;if(!r.trim(r("#subject_type").val()))return n.tips("请输入主体类型","#subject_type"),r("#subject_type").focus(),!1;if(!r.trim(r("#start_data").val()))return n.tips("请选择成立日期","#start_data"),r("#start_data").focus(),!1;if(!r.trim(r("#license_add").val()))return n.tips("请输入营业执照住所","#start_data"),r("#license_add").focus(),!1;if(!r.trim(r("#P_account").val()))return n.tips("请选输入对公账户","#P_account"),r("#P_account").focus(),!1;if(!r.trim(r("#P_account_bank").val()))return n.tips("请选输入对公户开户行名称","#P_account_bank"),r("#P_account_bank").focus(),!1;if(!r.trim(r("#P_account_bank_num").val()))return n.tips("请选输入对公开户行行号","#P_account_bank_num"),r("#P_account_bank_num").focus(),!1;if(!r.trim(r("#credit_code").val()))return n.tips("请选输入统一信用代码","#credit_code"),r("#credit_code").focus(),!1;n.load(1);var e=new Object;e.company_name=r.trim(r("#company_name").val()),e.corporate=r.trim(r("#corporate").val()),e.subject_type=r.trim(r("#subject_type").val()),e.start_data=r.trim(r("#start_data").val()),e.license_add=r.trim(r("#license_add").val()),e.P_account=r.trim(r("#P_account").val()),e.P_account_bank=r.trim(r("#P_account_bank").val()),e.P_account_bank_num=r.trim(r("#P_account_bank_num").val()),e.credit_code=r.trim(r("#credit_code").val());var t=r("#company_register").attr("ajax_url");r.ajax({type:"post",url:t,dataType:"json",data:e,async:!0,success:function(e){return n.closeAll("loading"),e.status?void n.alert(e.info,{icon:6,title:"成功",closeBtn:0},function(){window.location.href=e.jump}):(n.alert(e.info,{icon:5,title:"提示",closeBtn:0}),!1)},error:function(){return n.closeAll("loading"),n.alert(i.REQUEST_DATA_FAILED,{icon:2,title:"失败",closeBtn:0}),!1}})}),r("#protocol_risk").click(function(){n.open({type:1,area:["800px","650px"],title:"注册协议",content:r(".protocol_con")})}),r(".protocol_con .closebtn a").live("click",function(){n.closeAll()})});